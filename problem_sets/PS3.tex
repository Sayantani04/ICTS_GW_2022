% This is a template for doing homework assignments in LaTeX

\documentclass{article} % This command is used to set the type of document you are working on such as an article, book, or presenation

\usepackage[margin=1in,footskip=0.25in]{geometry} % This package allows the editing of the page layout
\usepackage{amsmath}  % This package allows the use of a large range of mathematical formula, commands, and symbols
\usepackage{graphicx}  % This package allows the importing of images
\usepackage{hyperref}
\usepackage{physics}

\newcommand{\question}[2][]{\begin{flushleft}
        \textbf{Problem #1}: %\textbf{Gaussian - Gaussian Model}  
\end{flushleft}
}

\newcommand{\sol}{\textbf{Solution}:} %Use if you want a boldface solution line
\newcommand{\maketitletwo}[2][]{\begin{center}
        \Large{\textbf{Problem Set - 3}
            
            Compact Binary Evolution, Rates and Population Modelling} % Name of course here
        \vspace{10pt}
        
        \normalsize{Aditya Vijaykumar, Soummyadip Basak  % Your name here
        } \\
        \vspace{5pt}  June 8, 2022     % Change to due date if preferred
        \vspace{15pt}
        
\end{center}}
\begin{document}
    \maketitletwo[5]  % Optional argument is assignment number
    %Keep a blank space between maketitletwo and \question[1]
    
    \question[1]{} \textbf{Inverse Problems:} Unstable particles are emitted from a source and decay at a distance $x$, a real number that has an exponential probability distribution with characteristic length $\lambda$. That is:
    \begin{equation}
    	P(x) \sim \exp(- x / \lambda) \qq{.}
    \end{equation}
    Decay events can only be observed only if they occur in a window extending from $x = 1 \mathrm{cm}$ to $x = 20 \mathrm{ cm} $. $N$ decays are observed at locations $\{x_1, x_2 \ldots, x_N\}$. What is the estimated value of $ \lambda $ from this experiment?
    
    \begin{enumerate}
    \item[(a)] Write down a few possible ways to solve this problem. What are the pitfalls of these methods?
    \item[(b)]  Bayes Theorem to solve this problem. Define the likelihood, prior etc. and put it into Bayes theorem. By the end of this problem, you should be convinced that the Bayes theorem is an extremely useful tool to solve inverse problems!
    \item[(c)] \textbf{[Bonus]} Use a Markov Chain Monte Carlo (MCMC) sampler like \texttt{emcee} to solve this problem.
    \item[(d)]  \textbf{[Bonus]}  Write your own MCMC algorithm.
    \end{enumerate}

    \question[2]{}\textbf{A Simple Introduction to the Bayes Theorem (The Monty Hall Problem):} 
    On a game show, a contestant is told the rules as follows: 
    
    \begin{itemize}
    \item There are three doors, labelled 1, 2, 3. A single prize has been hidden behind one of them. You get to select one door. 
    \item Initially your chosen door will not be opened. Instead, the gameshow host will open one of the other two doors, doing so in such a way as not to reveal the prize. For example, if you first choose door 1, one of doors 2 and 3 will be opened, and it is guaranteed that the door opened will not reveal the prize. 
    \item At this point, you will be given a fresh choice of door: you can either stick with your first choice, or you can switch to the other closed door. All the doors will then be opened and you will receive whatever is behind your final choice of door. Imagine that the contestant chooses door 1 first; then the gameshow host opens door 3, revealing nothing behind the door, as promised. 
    \end{itemize}
    
    Given these rules, should the contestant:
    
    \begin{enumerate}
    	\item[(a)] Stick with door 1.
    	\item[(b)] Switch to door 2.
    	\item[(c)] Doesn't matter what the contestant does.
    \end{enumerate}
    
    
    \question[3]{} 
    \textbf{Fitting problems:} 
    
    \begin{enumerate}
    	
    \item[(a)] Write down the equation for a straight line, and choose a value for the slope and the intercept. Simulate some data assuming the line as the signal, and adding some gaussian noise. 
    
    \item[(b)] Now estimate the parameters of the line from data by:
    \begin{itemize}
    	\item Gridding the space of parameters.
   		\item Using traditional $ \chi^2$ fitting methods, such as \texttt{scipy.optimize.curve\_fit}.
   		\item A Markov Chain Monte Carlo sampler like emcee
   	\end{itemize}
    Discuss stability and costs of each of these methods.
    
    
    \item[(c)] Now repeat the above problem for your favourite  $n$-th order ($n\ge3$)  polynomial.
    
    \end{enumerate}
    
    
    \question[4]{} \textbf{Posterior Samples from GW150914:}
    Download posterior samples of GW150914 from \href{https://drive.google.com/drive/folders/1L2xsQM4mfoljLTlTrF6nTbvZ1yM0l4hH?usp=sharing}{this link}.
    \begin{enumerate}
   	\item[(a)] Plot the parameters on a corner plot by using the \texttt{corner}\footnote{https://pypi.org/project/corner/} package. You can also try using the \texttt{pesummary}\footnote{https://pypi.org/project/pesummary/} package for the same.
    \item[(b)] What correlations do you see? Can you explain these correlations from your theoretical understanding?
    \item[(c)] Come up with different ways in which you can define credible intervals. Draw 90\% credible intervals with these samples, and quote all the numbers.
    \end{enumerate}
    

\end{document}