% This is a template for doing homework assignments in LaTeX

\documentclass{article} % This command is used to set the type of document you are working on such as an article, book, or presenation

\usepackage[margin=1in,footskip=0.25in]{geometry} % This package allows the editing of the page layout
\usepackage{amsmath}  % This package allows the use of a large range of mathematical formula, commands, and symbols
\usepackage{graphicx}  % This package allows the importing of images
\usepackage{hyperref}

\newcommand{\question}[2][]{\begin{flushleft}
        \textbf{Problem #1}: %\textbf{Gaussian - Gaussian Model}  
\end{flushleft}
}

\newcommand{\sol}{\textbf{Solution}:} %Use if you want a boldface solution line
\newcommand{\maketitletwo}[2][]{\begin{center}
        \Large{\textbf{Problem Set - 1}
            
            Forming merging binaries} % Name of course here
        \vspace{10pt}
        
        \normalsize{Sayantani Datta, Md Arif Shaikh  % Your name here
        } \\
        \vspace{5pt}  June 7, 2022     % Change to due date if preferred
        \vspace{15pt}
        
\end{center}}
\begin{document}
    \maketitletwo[5]  % Optional argument is assignment number
    %Keep a blank space between maketitletwo and \question[1]
    
    \question[1]{} \textbf{Binary evolution:} Consider two point masses inspiraling around each other under gravitational radiation reaction. The average energy emission rate for such a system is given by,
    \begin{equation}\label{energyloss}
\frac{dE}{dt} = -\frac{32}{5}\frac{G^4 m_1^2 m_2^2 (m_1+m_2)}{c^5 a^5(1-e^2)^{\frac{7}{2}}} \left( 1 + \frac{73}{24}e^2+\frac{37}{96}e^4\right)
    \end{equation}
    
    The average angular momentum emission rate is,
    \begin{equation}\label{momentumloss}
     \frac{dJ}{dt} = -\frac{32}{5}\frac{G^{\frac{7}{2}} m_1^2 m_2^2 (m_1+m_2)^{\frac{1}{2}}}{c^5 a^{\frac{7}{2}}(1-e^2)^2} \left( 1 + \frac{7}{8}e^2\right)
     \end{equation}
     
     \begin{enumerate}
     \item Use $\mathrm{\frac{dE}{dt}}$ or $\mathrm{\frac{dJ}{dt}}$ to calculate the change in the separation between the two bodies. Assume circular case for simplification.
     \item Use the expression of the change in the separation between the two bodies to obtain lifetime of the binary as a function of the initial separation, $\mathrm{a_0}$.
     \item Calculate the lifetime for a binary star with equal component masses of $1 M_{\odot}$ for a range of initial separation from 0.01 AU to 1 AU and plot it. Vary the mass ratio ($\mathrm{q=m_2/m_1}$ with $\mathrm{m_1 > m_2}$ ) and see how the lifetime changes for the same values of initial separation.
    [$\mathrm{G = 6.67\times10^{-8}\,cm^3g^{-1}s^{-2}}$, $\mathrm{c = 3.0\times10^10\,cm s^{-1}}$,
    $\mathrm{M_{\odot} = 1.99\times10^33\,g}$, $\mathrm{s = 3.17098\times10^{-8}\,yr}$, 
    $\mathrm{H_0 = 14.4\times10^9\,yr}$, \\
    $\mathrm{AU = 1.496\times10^13\,cm}$]
    
    \item Calculate the initial separation of the binary required for it to merge within the Hubble time. Compare this value with the typical radius of the star in its giant phase.
    
    \textit{Hint: Typical radius of a star in its giant phase is, $\mathrm{R_G = 1 AU}$. If $\mathrm{a_0 < R_G}$, the stars will engulf each other in this phase and will not form a binary. But, if $\mathrm{a_0 > R_G}$, the stars will not merge in Hubble time. This tells that some mechanism is needed to shrink the orbits, for the binaries to be close enough to merge through gravitational-wave emission, after they have evolved through their giant phase.}
    
    \item An approximate estimation of the radius of the Roche lobe is given by Eggletonâ€™s approximate formula,
    
    \begin{equation}
    \frac{r_1}{a} = \frac{0.49 q^{\frac{2}{3}}}{0.6 q^{\frac{2}{3}}+ ln(1+q^{\frac{1}{3}})},
    \end{equation}
    where, $\mathrm{r_1}$ is the radius of the Roche lobe around $\mathrm{m_1}$.
    
    Calculate the Roche lobe radius, for a range of separation values. See at what separation the stars would undergo mass transfer.
    
    \textit{Hint: Mass transfer will happen if $\mathrm{m_1}$ expands and fills its Roche lobe: $\mathrm{R_G>R_{Roche}}$.}
    
    \end{enumerate}
    
    \newpage
    
    \question[2]{} \textbf{Interpret multi-channel model data}: In this problem we will investigate some possible mechanisms of compact binary formation. Overplot posterior probability distributions of the instrinsic parameters from different models and explain the key differences.
    
    
    \begin{enumerate}
                \item Use \textsc{h5py} python package to read the .h5 file. 
                \item Data for each model can be extracted using the \textit{read\_hdf} function from {\textsc{pandas}} python package. Note that you will have to call each model by passing the corresponding key to \textit{read\_hdf} function.
                \item Extract samples for chirp mass ($\mathrm{\mathcal{M}_c}$) from every model by keeping  natal spin ($\mathrm{\chi_b}$) and common envelop efficiency ($\mathrm{\alpha_{CE}}$) fixed. Overplot them as posterior probability distributions (histograms) and explain the key differences. 
                \item Repeat the above for other intrinsic parameters like mass ratio ($\mathrm{q}$), effective spin parameter, ($\mathrm{\chi_{eff}}$) and redshift ($\mathrm{z}$).
                \item For some cases, you may not be able to distinguish clearly between the features for different models, when plotted as a histogram. For such cases do a kernel density estimate  using \textit{gaussian\_kde} function from {\textsc{scipy.stats}}.
            \end{enumerate}
    
    
    
        
        
 
        %\texit{This is a down-sampled version to make downloading easier. The original heavy data file can be found \href{here}{https://zenodo.org/record/4448170#.Yp0FexNBx-W}. Both should give very similar results.}

 
\end{document}
